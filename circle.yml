# CircleCI Build yaml
# General information
general:
  branches:
    only:
      - circleci

# Define VM
machine:
  # Timezone
  timezone: America/Los_Angeles

# Dependencies
dependencies:
  override:
    # Ruby 2.3.1
    - cd logging   && rvm-exec 2.3.1 bundle install && cd ..
    - cd bigquery  && rvm-exec 2.3.1 bundle install && cd ..
    - cd datastore && rvm-exec 2.3.1 bundle install && cd ..
    - cd language  && rvm-exec 2.3.1 bundle install && cd ..
    - cd pubsub    && rvm-exec 2.3.1 bundle install && cd ..
    - cd speech    && rvm-exec 2.3.1 bundle install && cd ..
    - cd storage   && rvm-exec 2.3.1 bundle install && cd ..
    - cd translate && rvm-exec 2.3.1 bundle install && cd ..
    - cd vision    && rvm-exec 2.3.1 bundle install && cd ..
    # Ruby 2.2.5
    - cd logging   && rvm-exec 2.2.5 bundle install && cd ..
    - cd bigquery  && rvm-exec 2.2.5 bundle install && cd ..
    - cd datastore && rvm-exec 2.2.5 bundle install && cd ..
    - cd language  && rvm-exec 2.2.5 bundle install && cd ..
    - cd pubsub    && rvm-exec 2.2.5 bundle install && cd ..
    - cd speech    && rvm-exec 2.2.5 bundle install && cd ..
    - cd storage   && rvm-exec 2.2.5 bundle install && cd ..
    - cd translate && rvm-exec 2.2.5 bundle install && cd ..
    - cd vision    && rvm-exec 2.2.5 bundle install && cd ..

# Test
test:
  override:
    # Ruby 2.3.1
    - cd logging   && rvm-exec 2.3.1 bundle exec rspec && cd ..
    - cd bigquery  && rvm-exec 2.3.1 bundle exec rspec && cd ..
    - cd datastore && rvm-exec 2.3.1 bundle exec rspec && cd ..
    - cd language  && rvm-exec 2.3.1 bundle exec rspec && cd ..
    - cd pubsub    && rvm-exec 2.3.1 bundle exec rspec && cd ..
    - cd speech    && rvm-exec 2.3.1 bundle exec rspec && cd ..
    - cd storage   && rvm-exec 2.3.1 bundle exec rspec && cd ..
    - cd translate && rvm-exec 2.3.1 bundle exec rspec && cd ..
    - cd vision    && rvm-exec 2.3.1 bundle exec rspec && cd ..
    # Ruby 2.2.5
    - cd logging   && rvm-exec 2.2.5 bundle exec rspec && cd ..
    - cd bigquery  && rvm-exec 2.2.5 bundle exec rspec && cd ..
    - cd datastore && rvm-exec 2.2.5 bundle exec rspec && cd ..
    - cd language  && rvm-exec 2.2.5 bundle exec rspec && cd ..
    - cd pubsub    && rvm-exec 2.2.5 bundle exec rspec && cd ..
    - cd speech    && rvm-exec 2.2.5 bundle exec rspec && cd ..
    - cd storage   && rvm-exec 2.2.5 bundle exec rspec && cd ..
    - cd translate && rvm-exec 2.2.5 bundle exec rspec && cd ..
    - cd vision    && rvm-exec 2.2.5 bundle exec rspec && cd ..

